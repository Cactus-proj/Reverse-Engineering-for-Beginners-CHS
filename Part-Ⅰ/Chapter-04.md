# 第四章
# 函数的开始和结束

函数的开始是在函数的开头的一系列的指令,一般看起来像下面这样的代码片段:

```
push  ebp
mov   ebp, esp
sub   esp, X
```

这些指令做了什么:将寄存器`EBP`的值入栈,将`ESP`赋值给`EBP`,然后在栈中分配空间, 用来保存局部变量。

在函数执行过程中,`EBP`是固定的,它可以用来访问局部变量和函数参数。也可以使用 `ESP`来达到相同的目的,但在函数运行过程中,`ESP`会变化,所以使用起来就不那么方便。

函数的结尾会释放栈中分配的空间，让`EBP`寄存器中的值返回到初始状态，并且将控制流程交给被调函数。

```
mov  esp, ebp
pop  ebp
ret  0
```
函数的开始和结尾通常用反汇编程序检测出，并用来界定函数的功能。

## 4.1 递归

函数的开始和结束对递归的效率有负面影响。

关于递归的详细介绍见：36.3